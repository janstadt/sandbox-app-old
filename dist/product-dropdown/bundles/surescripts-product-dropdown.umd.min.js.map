{"version":3,"sources":["ng://@surescripts/product-dropdown/lib/product.model.ts","ng://@surescripts/product-dropdown/lib/product-dropdown.component.ts","ng://@surescripts/product-dropdown/lib/product-dropdown.module.ts"],"names":["SurescriptsProduct","init","Object","assign","this","children","length","map","x","ProductDropdownComponent","http","prototype","ngOnInit","_this","ssoBaseUrl","Error","replace","get","withCredentials","pipe","resp","url","window","location","href","toLowerCase","selected","response","concat","filter","y","link","startsWith","longest","reduce","a","b","text","tap","products","subscribe","Component","args","selector","template","HttpClient","Input","ProductDropdownModule","NgModule","imports","CommonModule","HttpClientModule","NgbDropdownModule","declarations","exports"],"mappings":"2nBAAA,IAAAA,aAKuBC,GACfC,OAAOC,OAAOC,KAAMH,GAChBA,GAAQA,EAAKI,UAAYJ,EAAKI,SAASC,OAAS,IAChDF,KAAKC,SAAWJ,EAAKI,SAASE,IAAI,SAAAC,GAAK,OAAA,IAAIR,EAAmBQ,OCR1EC,EAAA,WAeE,SAAAA,EAAoBC,GAAAN,KAAAM,KAAAA,SAIpBD,EAAAE,UAAAC,SAAA,WAAA,IAAAC,EAAAT,KACE,IAAKA,KAAKU,WACR,MAAM,IAAIC,MAAM,6BAGlBX,KAAKU,WAAaV,KAAKU,WAAWE,QAAQ,OAAQ,IAClDZ,KAAKM,KAAKO,IAAkCb,KAAKU,WAAU,oBACvD,CAAEI,iBAAiB,IAAQC,KAAKZ,EAAAA,IAAI,SAAAa,GAClC,IAAMC,EAAMC,OAAOC,SAASC,KAAKC,cAC7BC,EAAW,GACTC,EAAWP,EAAKb,IAAI,SAAAC,GAQtB,OAPIA,EAAEH,UAAYG,EAAEH,SAASC,OAAS,EACpCoB,EAAWA,EAASE,OAAOpB,EAAEH,SAASwB,OAAO,SAAAC,GAAK,OAAAA,EAAEC,MAAQV,EAAIW,WAAWF,EAAEC,KAAKN,kBAE9EJ,EAAIW,WAAWxB,EAAEuB,MAAQvB,EAAEuB,KAAKN,iBAClCC,EAAWA,EAASE,OAAOpB,IAGxB,IAAIR,EAAmBQ,KAE5ByB,EAAUP,EAASpB,OAAS,EAAIoB,EAASQ,OAAO,SAAUC,EAAGC,GAAK,OAAOD,EAAEJ,KAAKzB,OAAS8B,EAAEL,KAAKzB,OAAS6B,EAAIC,IAAQ,KAE3H,OAAOT,EAASpB,IAAI,SAAAC,GAOlB,OANIyB,IACEzB,EAAEH,UAAYG,EAAEH,SAASC,OAAS,GAClCE,EAAEH,SAASE,IAAI,SAAAuB,GAAK,OAAAA,EAAEJ,SAAWI,EAAEO,OAASJ,EAAQI,MAAQP,EAAEC,OAASE,EAAQF,OAEnFvB,EAAEkB,SAAWlB,EAAE6B,OAASJ,EAAQI,MAAQ7B,EAAEuB,OAASE,EAAQF,MAEtDvB,MAEP8B,EAAAA,IAAI,SAAAlB,GAAQ,OAAAP,EAAK0B,SAAWnB,KAAOoB,iCA7C9CC,EAAAA,UAASC,KAAA,CAAC,CACTC,SAAU,+BACVC,SAAA,6yCANOC,EAAAA,kDAWNC,EAAAA,WAZH,GCAAC,EAAA,oDAMCC,EAAAA,SAAQN,KAAA,CAAC,CACRO,QAAS,CACPC,EAAAA,aACAC,EAAAA,iBACAC,EAAAA,mBAEFC,aAAc,CAAC5C,GACf6C,QAAS,CAAC7C,SAbZ","sourcesContent":["export class SurescriptsProduct {\r\n    text: string;\r\n    link: string;\r\n    selected: boolean;\r\n    children: Array<SurescriptsProduct>;\r\n    public constructor(init?: Partial<SurescriptsProduct>) {\r\n        Object.assign(this, init);\r\n        if (init && init.children && init.children.length > 0) {\r\n            this.children = init.children.map(x => new SurescriptsProduct(x));\r\n        }\r\n    }\r\n}\r\n","import { Component, OnInit, Input } from '@angular/core';\r\nimport { HttpClient } from '@angular/common/http';\r\nimport { SurescriptsProduct } from './product.model';\r\nimport { map, tap } from 'rxjs/operators';\r\n\r\n@Component({\r\n  selector: 'surescripts-product-dropdown',\r\n  templateUrl: './product-dropdown.component.html',\r\n  styleUrls: ['./product-dropdown.component.scss']\r\n})\r\nexport class ProductDropdownComponent implements OnInit {\r\n\r\n  @Input()\r\n  ssoBaseUrl: string;\r\n\r\n  constructor(private http: HttpClient) { }\r\n\r\n  products: Array<SurescriptsProduct>;\r\n\r\n  ngOnInit() {\r\n    if (!this.ssoBaseUrl) {\r\n      throw new Error('\"ssoBaseUrl\" is required.');\r\n    }\r\n\r\n    this.ssoBaseUrl = this.ssoBaseUrl.replace(/\\/+$/, '');\r\n    this.http.get<Array<SurescriptsProduct>>(`${this.ssoBaseUrl}/app/v1/user/menu`,\r\n        { withCredentials: true }).pipe(map(resp => {\r\n          const url = window.location.href.toLowerCase();\r\n          let selected = [];\r\n          const response = resp.map(x => {\r\n              if (x.children && x.children.length > 0) {\r\n                selected = selected.concat(x.children.filter(y => y.link && url.startsWith(y.link.toLowerCase())));\r\n              } else {\r\n                if (url.startsWith(x.link && x.link.toLowerCase())) {\r\n                  selected = selected.concat(x);\r\n                }\r\n              }\r\n              return new SurescriptsProduct(x);\r\n            });\r\n          const longest = selected.length > 0 ? selected.reduce(function (a, b) { return a.link.length > b.link.length ? a : b; }) : null;\r\n\r\n          return response.map(x => {\r\n            if (longest) {\r\n              if (x.children && x.children.length > 0) {\r\n                  x.children.map(y => y.selected = y.text === longest.text && y.link === longest.link);\r\n              }\r\n              x.selected = x.text === longest.text && x.link === longest.link;\r\n            }\r\n            return x;\r\n          });\r\n        }), tap(resp => this.products = resp)).subscribe();\r\n  }\r\n}\r\n","import { NgModule } from '@angular/core';\r\nimport { CommonModule } from '@angular/common';\r\nimport { HttpClientModule } from '@angular/common/http';\r\nimport { ProductDropdownComponent } from './product-dropdown.component';\r\nimport { NgbDropdownModule } from '@ng-bootstrap/ng-bootstrap';\r\n\r\n@NgModule({\r\n  imports: [\r\n    CommonModule,\r\n    HttpClientModule,\r\n    NgbDropdownModule\r\n  ],\r\n  declarations: [ProductDropdownComponent],\r\n  exports: [ProductDropdownComponent]\r\n})\r\nexport class ProductDropdownModule { }\r\n\r\nexport { SurescriptsProduct } from './product.model';\r\n"]}