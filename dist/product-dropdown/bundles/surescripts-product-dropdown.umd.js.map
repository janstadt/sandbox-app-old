{"version":3,"file":"surescripts-product-dropdown.umd.js","sources":["ng://@surescripts/product-dropdown/lib/product.model.ts","ng://@surescripts/product-dropdown/lib/product-dropdown.component.ts","ng://@surescripts/product-dropdown/lib/product-dropdown.module.ts"],"sourcesContent":["export class SurescriptsProduct {\r\n    text: string;\r\n    link: string;\r\n    selected: boolean;\r\n    children: Array<SurescriptsProduct>;\r\n    public constructor(init?: Partial<SurescriptsProduct>) {\r\n        Object.assign(this, init);\r\n        if (init && init.children && init.children.length > 0) {\r\n            this.children = init.children.map(x => new SurescriptsProduct(x));\r\n        }\r\n    }\r\n}\r\n","import { Component, OnInit, Input } from '@angular/core';\r\nimport { HttpClient } from '@angular/common/http';\r\nimport { SurescriptsProduct } from './product.model';\r\nimport { map, tap } from 'rxjs/operators';\r\n\r\n@Component({\r\n  selector: 'surescripts-product-dropdown',\r\n  templateUrl: './product-dropdown.component.html',\r\n  styleUrls: ['./product-dropdown.component.scss']\r\n})\r\nexport class ProductDropdownComponent implements OnInit {\r\n\r\n  @Input()\r\n  ssoBaseUrl: string;\r\n\r\n  constructor(private http: HttpClient) { }\r\n\r\n  products: Array<SurescriptsProduct>;\r\n\r\n  ngOnInit() {\r\n    if (!this.ssoBaseUrl) {\r\n      throw new Error('\"ssoBaseUrl\" is required.');\r\n    }\r\n\r\n    this.ssoBaseUrl = this.ssoBaseUrl.replace(/\\/+$/, '');\r\n    this.http.get<Array<SurescriptsProduct>>(`${this.ssoBaseUrl}/app/v1/user/menu`,\r\n        { withCredentials: true }).pipe(map(resp => {\r\n          const url = window.location.href.toLowerCase();\r\n          let selected = [];\r\n          const response = resp.map(x => {\r\n              if (x.children && x.children.length > 0) {\r\n                selected = selected.concat(x.children.filter(y => y.link && url.startsWith(y.link.toLowerCase())));\r\n              } else {\r\n                if (url.startsWith(x.link && x.link.toLowerCase())) {\r\n                  selected = selected.concat(x);\r\n                }\r\n              }\r\n              return new SurescriptsProduct(x);\r\n            });\r\n          const longest = selected.length > 0 ? selected.reduce(function (a, b) { return a.link.length > b.link.length ? a : b; }) : null;\r\n\r\n          return response.map(x => {\r\n            if (longest) {\r\n              if (x.children && x.children.length > 0) {\r\n                  x.children.map(y => y.selected = y.text === longest.text && y.link === longest.link);\r\n              }\r\n              x.selected = x.text === longest.text && x.link === longest.link;\r\n            }\r\n            return x;\r\n          });\r\n        }), tap(resp => this.products = resp)).subscribe();\r\n  }\r\n}\r\n","import { NgModule } from '@angular/core';\r\nimport { CommonModule } from '@angular/common';\r\nimport { HttpClientModule } from '@angular/common/http';\r\nimport { ProductDropdownComponent } from './product-dropdown.component';\r\nimport { NgbDropdownModule } from '@ng-bootstrap/ng-bootstrap';\r\n\r\n@NgModule({\r\n  imports: [\r\n    CommonModule,\r\n    HttpClientModule,\r\n    NgbDropdownModule\r\n  ],\r\n  declarations: [ProductDropdownComponent],\r\n  exports: [ProductDropdownComponent]\r\n})\r\nexport class ProductDropdownModule { }\r\n\r\nexport { SurescriptsProduct } from './product.model';\r\n"],"names":["map","tap","Component","HttpClient","Input","NgModule","CommonModule","HttpClientModule","NgbDropdownModule"],"mappings":"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"}