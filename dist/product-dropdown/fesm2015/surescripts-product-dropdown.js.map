{"version":3,"file":"surescripts-product-dropdown.js","sources":["ng://@surescripts/product-dropdown/lib/product.model.ts","ng://@surescripts/product-dropdown/lib/product-dropdown.component.ts","ng://@surescripts/product-dropdown/lib/product-dropdown.module.ts"],"sourcesContent":["export class SurescriptsProduct {\r\n    text: string;\r\n    link: string;\r\n    selected: boolean;\r\n    children: Array<SurescriptsProduct>;\r\n    public constructor(init?: Partial<SurescriptsProduct>) {\r\n        Object.assign(this, init);\r\n        if (init && init.children && init.children.length > 0) {\r\n            this.children = init.children.map(x => new SurescriptsProduct(x));\r\n        }\r\n    }\r\n}\r\n","import { Component, OnInit, Input } from '@angular/core';\r\nimport { HttpClient } from '@angular/common/http';\r\nimport { SurescriptsProduct } from './product.model';\r\nimport { map, tap } from 'rxjs/operators';\r\n\r\n@Component({\r\n  selector: 'surescripts-product-dropdown',\r\n  templateUrl: './product-dropdown.component.html',\r\n  styleUrls: ['./product-dropdown.component.scss']\r\n})\r\nexport class ProductDropdownComponent implements OnInit {\r\n\r\n  @Input()\r\n  ssoBaseUrl: string;\r\n\r\n  constructor(private http: HttpClient) { }\r\n\r\n  products: Array<SurescriptsProduct>;\r\n\r\n  ngOnInit() {\r\n    if (!this.ssoBaseUrl) {\r\n      throw new Error('\"ssoBaseUrl\" is required.');\r\n    }\r\n\r\n    this.ssoBaseUrl = this.ssoBaseUrl.replace(/\\/+$/, '');\r\n    this.http.get<Array<SurescriptsProduct>>(`${this.ssoBaseUrl}/app/v1/user/menu`,\r\n        { withCredentials: true }).pipe(map(resp => {\r\n          const url = window.location.href.toLowerCase();\r\n          let selected = [];\r\n          const response = resp.map(x => {\r\n              if (x.children && x.children.length > 0) {\r\n                selected = selected.concat(x.children.filter(y => y.link && url.startsWith(y.link.toLowerCase())));\r\n              } else {\r\n                if (url.startsWith(x.link && x.link.toLowerCase())) {\r\n                  selected = selected.concat(x);\r\n                }\r\n              }\r\n              return new SurescriptsProduct(x);\r\n            });\r\n          const longest = selected.length > 0 ? selected.reduce(function (a, b) { return a.link.length > b.link.length ? a : b; }) : null;\r\n\r\n          return response.map(x => {\r\n            if (longest) {\r\n              if (x.children && x.children.length > 0) {\r\n                  x.children.map(y => y.selected = y.text === longest.text && y.link === longest.link);\r\n              }\r\n              x.selected = x.text === longest.text && x.link === longest.link;\r\n            }\r\n            return x;\r\n          });\r\n        }), tap(resp => this.products = resp)).subscribe();\r\n  }\r\n}\r\n","import { NgModule } from '@angular/core';\r\nimport { CommonModule } from '@angular/common';\r\nimport { HttpClientModule } from '@angular/common/http';\r\nimport { ProductDropdownComponent } from './product-dropdown.component';\r\nimport { NgbDropdownModule } from '@ng-bootstrap/ng-bootstrap';\r\n\r\n@NgModule({\r\n  imports: [\r\n    CommonModule,\r\n    HttpClientModule,\r\n    NgbDropdownModule\r\n  ],\r\n  declarations: [ProductDropdownComponent],\r\n  exports: [ProductDropdownComponent]\r\n})\r\nexport class ProductDropdownModule { }\r\n\r\nexport { SurescriptsProduct } from './product.model';\r\n"],"names":[],"mappings":"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"}